<!DOCTYPE html>
<html>
<head>
<title>MATRIXxKINOTO</title>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<!-- Particles -->
<script src="https://cdn.jsdelivr.net/npm/tsparticles@2/tsparticles.bundle.min.js"></script>

<style>
body{
margin:0;
background:black;
color:white;
font-family:Arial;
overflow-x:hidden;
}

/* PARTICLES */
#particles-js{
position:fixed;
width:100%;
height:100%;
z-index:-1;
}

/* SIDEBAR */
#sidebar{
position:fixed;
left:-280px;
top:0;
width:280px;
height:100%;
background:#070707;
box-shadow:0 0 25px red;
transition:0.4s;
padding:20px;
z-index:1000;
}

#sidebar.show{
left:0;
}

.menuBtn{
position:fixed;
top:20px;
left:20px;
font-size:28px;
cursor:pointer;
z-index:1200;
color:red;
}

/* INPUTS */
input,textarea{
width:100%;
margin-top:12px;
padding:12px;
background:black;
border:1px solid red;
color:white;
outline:none;
}

button{
background:black;
border:1px solid red;
color:red;
padding:12px;
margin-top:15px;
width:100%;
cursor:pointer;
transition:0.3s;
}

button:hover{
background:red;
color:black;
}

/* FEED */
#feed{
padding:80px;
display:flex;
flex-wrap:wrap;
gap:30px;
justify-content:center;
}

/* POST BOX */
.post{
width:340px;
background:#060606;
border:1px solid red;
box-shadow:0 0 25px rgba(255,0,0,0.6);
padding:18px;
border-radius:12px;
transition:0.3s;
}

.post:hover{
transform:scale(1.03);
box-shadow:0 0 40px red;
}

.post img{
width:100%;
margin-top:12px;
border-radius:10px;
}

.user{
font-size:12px;
opacity:0.7;
color:#ff4d4d;
}

.title{
font-size:20px;
margin-top:6px;
color:red;
font-weight:bold;
}

/* FOLLOW CURSOR */
#follower{
position:fixed;
width:14px;
height:14px;
border-radius:50%;
background:red;
box-shadow:0 0 15px red,0 0 35px red;
pointer-events:none;
z-index:9999;
}
</style>
</head>

<body>

<div id="particles-js"></div>

<div class="menuBtn" onclick="toggleMenu()">â˜°</div>

<!-- SIDEBAR -->
<div id="sidebar">
<h2 style="color:red">Create Post</h2>

<input id="title" placeholder="Title">
<textarea id="message" placeholder="Message"></textarea>
<input type="file" id="image">

<button onclick="uploadPost()">UPLOAD</button>
</div>

<!-- FEED -->
<div id="feed"></div>
<div id="follower"></div>

<script>
/* FIREBASE CONFIG */
const firebaseConfig = {
  apiKey: "AIzaSyAbV7OHp1-mroEGnprfW4rcddOpVjE9U9k",
  authDomain: "matrixxkinoto-1d31c.firebaseapp.com",
  projectId: "matrixxkinoto-1d31c",
  storageBucket: "matrixxkinoto-1d31c.firebasestorage.app",
  messagingSenderId: "480949525974",
  appId: "1:480949525974:web:4eef38de95a3b2628cd877",
};

firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();

/* USER FROM DISCORD LOGIN */
const username = localStorage.getItem("discordUser") || "Unknown";

/* SIDEBAR */
function toggleMenu(){
document.getElementById("sidebar").classList.toggle("show");
}

/* UPLOAD IMAGE CLOUDINARY */
async function uploadImage(file){
const formData = new FormData();
formData.append("file",file);
formData.append("upload_preset","matrixx");

const res = await fetch("https://api.cloudinary.com/v1_1/dctoowkot/image/upload",{
method:"POST",
body:formData
});
const data = await res.json();
return data.secure_url;
}

/* CREATE POST */
async function uploadPost(){
const title=document.getElementById("title").value;
const msg=document.getElementById("message").value;
const file=document.getElementById("image").files[0];

let imgURL="";

if(file){
imgURL=await uploadImage(file);
}

await db.collection("posts").add({
title:title,
message:msg,
image:imgURL,
user:username,
uid:username,
time:Date.now()
});

alert("Uploaded ðŸ”¥");
}

/* REALTIME GLOBAL POSTS */
db.collection("posts").orderBy("time","desc")
.onSnapshot(snapshot=>{
document.getElementById("feed").innerHTML="";

snapshot.forEach(doc=>{
const p=doc.data();

let del="";
/* ONLY UPLOADER CAN DELETE */
if(p.uid===username){
del=`<button onclick="deletePost('${doc.id}')">Delete</button>`;
}

document.getElementById("feed").innerHTML+=`
<div class="post">
<div class="user">Posted by: ${p.user}</div>
<div class="title">${p.title}</div>
<div>${p.message}</div>
${p.image?`<img src="${p.image}">`:""}
${del}
</div>
`;
});
});

/* DELETE */
function deletePost(id){
db.collection("posts").doc(id).delete();
}

/* PARTICLES RED */
tsParticles.load("particles-js", {
particles:{
number:{value:80},
color:{value:"#ff0000"},
links:{enable:true,color:"#ff0000"},
move:{enable:true,speed:1},
size:{value:2}
},
background:{color:"black"}
});

/* SMOOTH FOLLOWER */
const f=document.getElementById("follower");
let x=0,y=0,mx=0,my=0;

document.addEventListener("mousemove",e=>{
mx=e.clientX;
my=e.clientY;
});

function anim(){
x+=(mx-x)*0.15;
y+=(my-y)*0.15;
f.style.left=x+"px";
f.style.top=y+"px";
requestAnimationFrame(anim);
}
anim();
</script>

</body>
</html>
