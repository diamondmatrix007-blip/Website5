<!DOCTYPE html>
<html>
<head>
<title>MATRIXxKINOTO</title>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<style>
body{
background:#000;
color:white;
font-family:Arial;
margin:0;
overflow-x:hidden;
}

/* sidebar */
#sidebar{
position:fixed;
left:-260px;
top:0;
width:260px;
height:100%;
background:#050505;
box-shadow:0 0 20px cyan;
transition:0.4s;
padding:20px;
z-index:999;
}

#sidebar.show{left:0;}

.menuBtn{
position:fixed;
top:20px;
left:20px;
font-size:28px;
cursor:pointer;
z-index:1000;
}

button{
background:black;
border:1px solid cyan;
color:cyan;
padding:10px;
margin-top:10px;
width:100%;
cursor:pointer;
}

input,textarea{
width:100%;
margin-top:10px;
padding:10px;
background:black;
border:1px solid cyan;
color:white;
}

#feed{
margin-left:80px;
padding:40px;
display:flex;
flex-wrap:wrap;
gap:25px;
}

/* post box */
.post{
border:1px solid cyan;
box-shadow:0 0 15px cyan;
padding:15px;
width:320px;
background:#050505;
}

.post img{
width:100%;
margin-top:10px;
border-radius:8px;
}

.title{
font-size:20px;
font-weight:bold;
margin-top:5px;
}

.user{
font-size:12px;
opacity:0.7;
}

/* glow follower */
#follower{
position:fixed;
width:14px;
height:14px;
border-radius:50%;
background:cyan;
box-shadow:0 0 20px cyan,0 0 40px cyan;
pointer-events:none;
z-index:9999;
}
</style>
</head>

<body>

<div class="menuBtn" onclick="toggleMenu()">â˜°</div>

<div id="sidebar">
<h2>Create Post</h2>

<input id="title" placeholder="Title">
<textarea id="message" placeholder="Message"></textarea>
<input type="file" id="image">

<button onclick="uploadPost()">UPLOAD</button>
</div>

<div id="feed"></div>
<div id="follower"></div>

<script>
// firebase config
const firebaseConfig = {
  apiKey: "AIzaSyAbV7OHp1-mroEGnprfW4rcddOpVjE9U9k",
  authDomain: "matrixxkinoto-1d31c.firebaseapp.com",
  projectId: "matrixxkinoto-1d31c",
  storageBucket: "matrixxkinoto-1d31c.firebasestorage.app",
  messagingSenderId: "480949525974",
  appId: "1:480949525974:web:4eef38de95a3b2628cd877",
};
firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();

// get discord user
const username = localStorage.getItem("discordUser") || "Unknown";

// sidebar
function toggleMenu(){
document.getElementById("sidebar").classList.toggle("show");
}

// upload image to cloudinary
async function uploadImage(file){
const formData = new FormData();
formData.append("file",file);
formData.append("upload_preset","matrixx"); // we create next if needed

const res = await fetch("https://api.cloudinary.com/v1_1/dctoowkot/image/upload",{
method:"POST",
body:formData
});

const data = await res.json();
return data.secure_url;
}

// upload post
async function uploadPost(){
const title=document.getElementById("title").value;
const msg=document.getElementById("message").value;
const file=document.getElementById("image").files[0];

let imgURL="";

if(file){
imgURL=await uploadImage(file);
}

await db.collection("posts").add({
title:title,
message:msg,
image:imgURL,
user:username,
uid:username,
time:Date.now()
});

alert("Uploaded ðŸ”¥");
}

// load posts realtime
db.collection("posts").orderBy("time","desc")
.onSnapshot(snapshot=>{
document.getElementById("feed").innerHTML="";
snapshot.forEach(doc=>{
const p=doc.data();

let del="";
if(p.uid===username){
del=`<button onclick="deletePost('${doc.id}')">Delete</button>`;
}

document.getElementById("feed").innerHTML+=`
<div class="post">
<div class="user">${p.user}</div>
<div class="title">${p.title}</div>
<div>${p.message}</div>
${p.image?`<img src="${p.image}">`:""}
${del}
</div>
`;
});
});

// delete
function deletePost(id){
db.collection("posts").doc(id).delete();
}

// ultra smooth follower
const f=document.getElementById("follower");
let x=0,y=0;
let mx=0,my=0;

document.addEventListener("mousemove",e=>{
mx=e.clientX;
my=e.clientY;
});

function anim(){
x+=(mx-x)*0.18;
y+=(my-y)*0.18;
f.style.left=x+"px";
f.style.top=y+"px";
requestAnimationFrame(anim);
}
anim();
</script>

</body>
</html>
